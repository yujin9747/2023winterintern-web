package com.example.kepcoweb.repository

import jakarta.persistence.EntityManager
import org.springframework.beans.factory.annotation.Autowired
import org.springframework.stereotype.Repository

@Repository
class DatabaseRepository (
    @Autowired var em : EntityManager
) {

    private val dumppedQuery = "INSERT INTO `electric_rates_history` (`Id`,`UseVal`,`GB1`,`GB2`,`SelVal`,`BaseFee`,`LoadVal`,`SUF`,`FAF`,`WIF`,`createdAt`,`updatedAt`,`appliedPeriod`) VALUES " +
            "(18,1,1,'L',NULL,5550,NULL,107.7,85.9,106.0,'2024-01-25 04:25:32.000000','2024-01-25 04:25:32.000000','2023-11-09 00:00:00.000000'), " +
    "(19,1,1,'HA',1,6490,NULL,116.3,92.6,116.2,'2024-01-25 04:25:32.000000','2024-01-25 04:25:32.000000','2023-11-09 00:00:00.000000'), " +
    "(20,1,1,'HA',2,7470,NULL,111.5,88.0,109.7,'2024-01-25 04:25:32.000000','2024-01-25 04:25:32.000000','2023-11-09 00:00:00.000000'), " +
    "(21,1,1,'HB',1,6000,NULL,115.1,91.5,114.7,'2024-01-25 04:25:32.000000','2024-01-25 04:25:32.000000','2023-11-09 00:00:00.000000'), " +
    "(22,1,1,'HB',2,6900,NULL,110.4,86.9,108.6,'2024-01-25 04:25:32.000000','2024-01-25 04:25:32.000000','2023-11-09 00:00:00.000000'), " +
    "(23,1,1,'L',NULL,5550,NULL,107.7,85.9,106.0,'2024-01-25 04:25:33.000000','2024-01-25 04:25:33.000000','2024-01-01 00:00:00.000000'), " +
    "(24,1,1,'HA',1,6490,NULL,116.3,92.6,116.2,'2024-01-25 04:25:33.000000','2024-01-25 04:25:33.000000','2024-01-01 00:00:00.000000'), " +
    "(25,1,1,'HA',2,7470,NULL,111.5,88.0,109.7,'2024-01-25 04:25:33.000000','2024-01-25 04:25:33.000000','2024-01-01 00:00:00.000000'), " +
    "(26,1,1,'HB',1,6000,NULL,115.1,91.5,114.7,'2024-01-25 04:25:33.000000','2024-01-25 04:25:33.000000','2024-01-01 00:00:00.000000'), " +
    "(27,1,1,'HB',2,6900,NULL,110.4,86.9,108.6,'2024-01-25 04:25:33.000000','2024-01-25 04:25:33.000000','2024-01-01 00:00:00.000000'), " +
    "(28,1,2,'HA',1,6490,10,87.2,87.2,94.6,'2024-01-25 04:25:34.000000','2024-01-25 04:25:34.000000','2023-11-09 00:00:00.000000'), " +
    "(29,1,2,'HA',1,6490,20,113.0,92.0,111.5,'2024-01-25 04:25:34.000000','2024-01-25 04:25:34.000000','2023-11-09 00:00:00.000000'), " +
    "(30,1,2,'HA',1,6490,30,146.5,111.2,140.9,'2024-01-25 04:25:34.000000','2024-01-25 04:25:34.000000','2023-11-09 00:00:00.000000'), " +
    "(31,1,2,'HA',2,7470,10,82.3,82.3,89.7,'2024-01-25 04:25:34.000000','2024-01-25 04:25:34.000000','2023-11-09 00:00:00.000000'), " +
    "(32,1,2,'HA',2,7470,20,108.1,87.1,106.6,'2024-01-25 04:25:34.000000','2024-01-25 04:25:34.000000','2023-11-09 00:00:00.000000'), " +
    "(33,1,2,'HA',2,7470,30,141.6,106.3,136.0,'2024-01-25 04:25:35.000000','2024-01-25 04:25:35.000000','2023-11-09 00:00:00.000000'), " +
    "(34,1,2,'HB',1,6000,10,84.0,84.0,91.2,'2024-01-25 04:25:35.000000','2024-01-25 04:25:35.000000','2023-11-09 00:00:00.000000'), " +
    "(35,1,2,'HB',1,6000,20,111.6,90.6,109.2,'2024-01-25 04:25:35.000000','2024-01-25 04:25:35.000000','2023-11-09 00:00:00.000000'), " +
    "(36,1,2,'HB',1,6000,30,145.4,109.4,137.9,'2024-01-25 04:25:35.000000','2024-01-25 04:25:35.000000','2023-11-09 00:00:00.000000'), " +
    "(37,1,2,'HB',2,6900,10,79.5,79.5,86.7,'2024-01-25 04:25:35.000000','2024-01-25 04:25:35.000000','2023-11-09 00:00:00.000000'), " +
    "(38,1,2,'HB',2,6900,20,107.1,86.1,104.7,'2024-01-25 04:25:35.000000','2024-01-25 04:25:35.000000','2023-11-09 00:00:00.000000'), " +
    "(39,1,2,'HB',2,6900,30,140.9,104.9,133.4,'2024-01-25 04:25:35.000000','2024-01-25 04:25:35.000000','2023-11-09 00:00:00.000000'), " +
    "(40,1,2,'HA',1,6490,10,87.2,87.2,94.6,'2024-01-25 04:25:36.000000','2024-01-25 04:25:36.000000','2024-01-01 00:00:00.000000'), " +
    "(41,1,2,'HA',1,6490,20,113.0,92.0,111.5,'2024-01-25 04:25:36.000000','2024-01-25 04:25:36.000000','2024-01-01 00:00:00.000000'), " +
    "(42,1,2,'HA',1,6490,30,146.5,111.2,140.9,'2024-01-25 04:25:36.000000','2024-01-25 04:25:36.000000','2024-01-01 00:00:00.000000'), " +
    "(43,1,2,'HA',2,7470,10,82.3,82.3,89.7,'2024-01-25 04:25:36.000000','2024-01-25 04:25:36.000000','2024-01-01 00:00:00.000000'), " +
    "(44,1,2,'HA',2,7470,20,108.1,87.1,106.6,'2024-01-25 04:25:36.000000','2024-01-25 04:25:36.000000','2024-01-01 00:00:00.000000'), " +
    "(45,1,2,'HA',2,7470,30,141.6,106.3,136.0,'2024-01-25 04:25:37.000000','2024-01-25 04:25:37.000000','2024-01-01 00:00:00.000000'), " +
    "(46,1,2,'HB',1,6000,10,84.0,84.0,91.2,'2024-01-25 04:25:37.000000','2024-01-25 04:25:37.000000','2024-01-01 00:00:00.000000'), " +
    "(47,1,2,'HB',1,6000,20,111.6,90.6,109.2,'2024-01-25 04:25:37.000000','2024-01-25 04:25:37.000000','2024-01-01 00:00:00.000000'), " +
    "(48,1,2,'HB',1,6000,30,145.4,109.4,137.9,'2024-01-25 04:25:37.000000','2024-01-25 04:25:37.000000','2024-01-01 00:00:00.000000'), " +
    "(49,1,2,'HB',2,6900,10,79.5,79.5,86.7,'2024-01-25 04:25:37.000000','2024-01-25 04:25:37.000000','2024-01-01 00:00:00.000000'), " +
    "(50,1,2,'HB',2,6900,20,107.1,86.1,104.7,'2024-01-25 04:25:37.000000','2024-01-25 04:25:37.000000','2024-01-01 00:00:00.000000'), " +
    "(51,1,2,'HB',2,6900,30,140.9,104.9,133.4,'2024-01-25 04:25:37.000000','2024-01-25 04:25:37.000000','2024-01-01 00:00:00.000000'), " +
    "(52,1,3,'HA',1,7220,10,99.5,99.5,106.5,'2024-01-25 04:25:39.000000','2024-01-25 04:25:39.000000','2023-11-09 00:00:00.000000'), " +
    "(53,1,3,'HA',1,7220,20,152.4,122.0,152.6,'2024-01-25 04:25:39.000000','2024-01-25 04:25:39.000000','2023-11-09 00:00:00.000000'), " +
    "(54,1,3,'HA',1,7220,30,234.5,152.7,210.1,'2024-01-25 04:25:39.000000','2024-01-25 04:25:39.000000','2023-11-09 00:00:00.000000'), " +
    "(55,1,3,'HA',2,8320,10,94.0,94.0,101.0,'2024-01-25 04:25:39.000000','2024-01-25 04:25:39.000000','2023-11-09 00:00:00.000000'), " +
    "(56,1,3,'HA',2,8320,20,146.9,116.5,147.1,'2024-01-25 04:25:40.000000','2024-01-25 04:25:40.000000','2023-11-09 00:00:00.000000'), " +
    "(57,1,3,'HA',2,8320,30,229.0,147.2,204.6,'2024-01-25 04:25:40.000000','2024-01-25 04:25:40.000000','2023-11-09 00:00:00.000000'), " +
    "(58,1,3,'HA',3,9810,10,93.1,93.1,100.4,'2024-01-25 04:25:40.000000','2024-01-25 04:25:40.000000','2023-11-09 00:00:00.000000'), " +
    "(59,1,3,'HA',3,9810,20,146.3,115.2,146.5,'2024-01-25 04:25:40.000000','2024-01-25 04:25:40.000000','2023-11-09 00:00:00.000000'), " +
    "(60,1,3,'HA',3,9810,30,216.6,138.9,193.4,'2024-01-25 04:25:41.000000','2024-01-25 04:25:41.000000','2023-11-09 00:00:00.000000'), " +
    "(61,1,3,'HB',1,6630,10,109.4,109.4,116.4,'2024-01-25 04:25:41.000000','2024-01-25 04:25:41.000000','2023-11-09 00:00:00.000000'), " +
    "(62,1,3,'HB',1,6630,20,161.7,131.7,161.7,'2024-01-25 04:25:41.000000','2024-01-25 04:25:41.000000','2023-11-09 00:00:00.000000'), " +
    "(63,1,3,'HB',1,6630,30,242.9,162.0,217.9,'2024-01-25 04:25:41.000000','2024-01-25 04:25:41.000000','2023-11-09 00:00:00.000000'), " +
    "(64,1,3,'HB',2,7380,10,105.6,105.6,112.6,'2024-01-25 04:25:41.000000','2024-01-25 04:25:41.000000','2023-11-09 00:00:00.000000'), " +
    "(65,1,3,'HB',2,7380,20,157.9,127.9,157.9,'2024-01-25 04:25:42.000000','2024-01-25 04:25:42.000000','2023-11-09 00:00:00.000000'), " +
    "(66,1,3,'HB',2,7380,30,239.1,158.2,214.1,'2024-01-25 04:25:42.000000','2024-01-25 04:25:42.000000','2023-11-09 00:00:00.000000'), " +
    "(67,1,3,'HB',3,8190,10,103.9,103.9,111.0,'2024-01-25 04:25:42.000000','2024-01-25 04:25:42.000000','2023-11-09 00:00:00.000000'), " +
    "(68,1,3,'HB',3,8190,20,156.2,126.3,156.2,'2024-01-25 04:25:42.000000','2024-01-25 04:25:42.000000','2023-11-09 00:00:00.000000'), " +
    "(69,1,3,'HB',3,8190,30,237.5,156.6,212.4,'2024-01-25 04:25:43.000000','2024-01-25 04:25:43.000000','2023-11-09 00:00:00.000000'), " +
    "(70,1,3,'HC',1,6590,10,108.9,108.9,115.8,'2024-01-25 04:25:43.000000','2024-01-25 04:25:43.000000','2023-11-09 00:00:00.000000'), " +
    "(71,1,3,'HC',1,6590,20,161.8,131.8,161.4,'2024-01-25 04:25:43.000000','2024-01-25 04:25:43.000000','2023-11-09 00:00:00.000000'), " +
    "(72,1,3,'HC',1,6590,30,242.7,162.2,218.0,'2024-01-25 04:25:44.000000','2024-01-25 04:25:44.000000','2023-11-09 00:00:00.000000'), " +
    "(73,1,3,'HC',2,7520,10,104.2,104.2,111.1,'2024-01-25 04:25:44.000000','2024-01-25 04:25:44.000000','2023-11-09 00:00:00.000000'), " +
    "(74,1,3,'HC',2,7520,20,157.1,127.1,156.7,'2024-01-25 04:25:44.000000','2024-01-25 04:25:44.000000','2023-11-09 00:00:00.000000'), " +
    "(75,1,3,'HC',2,7520,30,238.0,157.5,213.3,'2024-01-25 04:25:44.000000','2024-01-25 04:25:44.000000','2023-11-09 00:00:00.000000'), " +
    "(76,1,3,'HC',3,8090,10,103.1,103.1,110.0,'2024-01-25 04:25:44.000000','2024-01-25 04:25:44.000000','2023-11-09 00:00:00.000000'), " +
    "(77,1,3,'HC',3,8090,20,156.0,126.0,155.6,'2024-01-25 04:25:44.000000','2024-01-25 04:25:44.000000','2023-11-09 00:00:00.000000'), " +
    "(78,1,3,'HC',3,8090,30,236.9,156.4,212.2,'2024-01-25 04:25:44.000000','2024-01-25 04:25:44.000000','2023-11-09 00:00:00.000000'), " +
    "(79,1,3,'HA',1,7220,10,99.5,99.5,106.5,'2024-01-25 04:25:45.000000','2024-01-25 04:25:45.000000','2024-01-01 00:00:00.000000'), " +
    "(80,1,3,'HA',1,7220,20,152.4,122.0,152.6,'2024-01-25 04:25:45.000000','2024-01-25 04:25:45.000000','2024-01-01 00:00:00.000000'), " +
    "(81,1,3,'HA',1,7220,30,234.5,152.7,210.1,'2024-01-25 04:25:45.000000','2024-01-25 04:25:45.000000','2024-01-01 00:00:00.000000'), " +
    "(82,1,3,'HA',2,8320,10,94.0,94.0,101.0,'2024-01-25 04:25:45.000000','2024-01-25 04:25:45.000000','2024-01-01 00:00:00.000000'), " +
    "(83,1,3,'HA',2,8320,20,146.9,116.5,147.1,'2024-01-25 04:25:46.000000','2024-01-25 04:25:46.000000','2024-01-01 00:00:00.000000'), " +
    "(84,1,3,'HA',2,8320,30,229.0,147.2,204.6,'2024-01-25 04:25:46.000000','2024-01-25 04:25:46.000000','2024-01-01 00:00:00.000000'), " +
    "(85,1,3,'HA',3,9810,10,93.1,93.1,100.4,'2024-01-25 04:25:46.000000','2024-01-25 04:25:46.000000','2024-01-01 00:00:00.000000'), " +
    "(86,1,3,'HA',3,9810,20,146.3,115.2,146.5,'2024-01-25 04:25:46.000000','2024-01-25 04:25:46.000000','2024-01-01 00:00:00.000000'), " +
    "(87,1,3,'HA',3,9810,30,216.6,138.9,193.4,'2024-01-25 04:25:46.000000','2024-01-25 04:25:46.000000','2024-01-01 00:00:00.000000'), " +
    "(88,1,3,'HB',1,6630,10,109.4,109.4,116.4,'2024-01-25 04:25:46.000000','2024-01-25 04:25:46.000000','2024-01-01 00:00:00.000000'), " +
    "(89,1,3,'HB',1,6630,20,161.7,131.7,161.7,'2024-01-25 04:25:46.000000','2024-01-25 04:25:46.000000','2024-01-01 00:00:00.000000'), " +
    "(90,1,3,'HB',1,6630,30,242.9,162.0,217.9,'2024-01-25 04:25:46.000000','2024-01-25 04:25:46.000000','2024-01-01 00:00:00.000000'), " +
    "(91,1,3,'HB',2,7380,10,105.6,105.6,112.6,'2024-01-25 04:25:46.000000','2024-01-25 04:25:46.000000','2024-01-01 00:00:00.000000'), " +
    "(92,1,3,'HB',2,7380,20,157.9,127.9,157.9,'2024-01-25 04:25:47.000000','2024-01-25 04:25:47.000000','2024-01-01 00:00:00.000000'), " +
    "(93,1,3,'HB',2,7380,30,239.1,158.2,214.1,'2024-01-25 04:25:47.000000','2024-01-25 04:25:47.000000','2024-01-01 00:00:00.000000'), " +
    "(94,1,3,'HB',3,8190,10,103.9,103.9,111.0,'2024-01-25 04:25:47.000000','2024-01-25 04:25:47.000000','2024-01-01 00:00:00.000000'), " +
    "(95,1,3,'HB',3,8190,20,156.2,126.3,156.2,'2024-01-25 04:25:47.000000','2024-01-25 04:25:47.000000','2024-01-01 00:00:00.000000'), " +
    "(96,1,3,'HB',3,8190,30,237.5,156.6,212.4,'2024-01-25 04:25:47.000000','2024-01-25 04:25:47.000000','2024-01-01 00:00:00.000000'), " +
    "(97,1,3,'HC',1,6590,10,108.9,108.9,115.8,'2024-01-25 04:25:47.000000','2024-01-25 04:25:47.000000','2024-01-01 00:00:00.000000'), " +
    "(98,1,3,'HC',1,6590,20,161.8,131.8,161.4,'2024-01-25 04:25:47.000000','2024-01-25 04:25:47.000000','2024-01-01 00:00:00.000000'), " +
    "(99,1,3,'HC',1,6590,30,242.7,162.2,218.0,'2024-01-25 04:25:47.000000','2024-01-25 04:25:47.000000','2024-01-01 00:00:00.000000'), " +
    "(100,1,3,'HC',2,7520,10,104.2,104.2,111.1,'2024-01-25 04:25:48.000000','2024-01-25 04:25:48.000000','2024-01-01 00:00:00.000000'), " +
    "(101,1,3,'HC',2,7520,20,157.1,127.1,156.7,'2024-01-25 04:25:48.000000','2024-01-25 04:25:48.000000','2024-01-01 00:00:00.000000'), " +
    "(102,1,3,'HC',2,7520,30,238.0,157.5,213.3,'2024-01-25 04:25:48.000000','2024-01-25 04:25:48.000000','2024-01-01 00:00:00.000000'), " +
    "(103,1,3,'HC',3,8090,10,103.1,103.1,110.0,'2024-01-25 04:25:48.000000','2024-01-25 04:25:48.000000','2024-01-01 00:00:00.000000'), " +
    "(104,1,3,'HC',3,8090,20,156.0,126.0,155.6,'2024-01-25 04:25:48.000000','2024-01-25 04:25:48.000000','2024-01-01 00:00:00.000000'), " +
    "(105,1,3,'HC',3,8090,30,236.9,156.4,212.2,'2024-01-25 04:25:48.000000','2024-01-25 04:25:48.000000','2024-01-01 00:00:00.000000');"

    fun dropTables() {
        em.createNativeQuery("drop table if exists electric_rates").executeUpdate()
        em.createNativeQuery("drop table if exists electric_rates_timeLoad").executeUpdate()
        em.createNativeQuery("drop table if exists electric_rates_month_season").executeUpdate()
        em.createNativeQuery("drop table if exists electric_rates_history").executeUpdate()
        em.createNativeQuery("drop table if exists electric_rates_timeLoad_history").executeUpdate()
        em.createNativeQuery("drop table if exists electric_rates_month_season_history").executeUpdate()
    }

    fun deleteAllHistory() {
        em.createNativeQuery("delete from electric_rates_history").executeUpdate()
//        em.createNativeQuery("delete from electric_rates_timeLoad_history").executeUpdate()
//        em.createNativeQuery("delete from electric_rates_month_season_history").executeUpdate()
    }

    fun insertDefaultHistory() {
        em.createNativeQuery(dumppedQuery).executeUpdate()
    }

}